<div class="container-fluid py-4">
  <!-- Header Section -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card shadow-sm border-0 bg-gradient-primary">
        <div class="card-body p-5 text-white">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h1 class="display-5 fw-bold mb-3 text-light">
                <i class="ti ti-calendar-event me-3"></i>Upcoming Events
              </h1>
              <p class="lead mb-0">
                Discover and reserve your spot at the most exciting events
                happening near you
              </p>
            </div>
            <div class="col-md-4 text-md-end">
              <div
                class="bg-white bg-opacity-25 rounded-pill p-3 d-inline-block"
              >
                <i class="ti ti-ticket fs-1"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Search and Filter Section -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card shadow-sm border-0">
        <div class="card-body p-4">
          <div class="row g-3 align-items-end">
            <div class="col-md-6">
              <label class="form-label fw-semibold">Search Events</label>
              <div class="input-group">
                <span class="input-group-text bg-light border-0">
                  <i class="ti ti-search text-muted"></i>
                </span>
                <input
                  type="text"
                  class="form-control border-0 bg-light"
                  placeholder="Search by event name, location..."
                  [(ngModel)]="searchTerm"
                  (input)="searchEvents()"
                />
              </div>
            </div>
            <div class="col-md-4">
              <label class="form-label fw-semibold">Filter by Category</label>
              <select
                class="form-select bg-light border-0"
                [(ngModel)]="selectedCategory"
                (change)="filterByCategory()"
              >
                <option
                  *ngFor="let category of getEventCategories()"
                  [value]="category"
                >
                  {{ category }}
                </option>
              </select>
            </div>
            <div class="col-md-2">
              <button
                class="btn btn-primary w-100"
                (click)="loadUpcomingEvents()"
              >
                <i class="ti ti-refresh me-2"></i>Refresh
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div class="row mb-4" *ngIf="errorMessage">
    <div class="col-12">
      <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="ti ti-alert-triangle me-2"></i>
        {{ errorMessage }}
        <button
          type="button"
          class="btn-close"
          (click)="errorMessage = ''"
        ></button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="row" *ngIf="isLoading">
    <div class="col-12">
      <div class="card shadow-sm border-0">
        <div class="card-body text-center py-5">
          <div
            class="spinner-border text-primary"
            style="width: 3rem; height: 3rem"
            role="status"
          >
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-3 text-muted fs-5">Loading upcoming events...</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Events Grid -->
  <div class="row" *ngIf="!isLoading">
    <div class="col-12">
      <div class="row g-4">
        <div class="col-12" *ngIf="filteredEvents.length === 0">
          <div class="card shadow-sm border-0">
            <div class="card-body text-center py-5">
              <i class="ti ti-calendar-off fs-1 text-muted d-block mb-3"></i>
              <h4 class="text-muted">No events found</h4>
              <p class="text-muted">
                Try adjusting your search or filter criteria
              </p>
            </div>
          </div>
        </div>

        <div class="col-md-6 col-lg-4" *ngFor="let event of filteredEvents">
          <div class="card shadow-sm border-0 h-100 event-card">
            <div class="card-header border-0 p-0 position-relative">
              <div class="event-image-placeholder bg-light rounded-top">
                <i class="ti ti-calendar-event text-muted fs-1"></i>
              </div>
              <span
                class="position-absolute top-0 end-0 m-3 badge {{
                  getCategoryClass(event.category)
                }}"
              >
                {{ event.category }}
              </span>
              <span class="position-absolute top-0 start-0 m-3 badge bg-dark">
                <i class="ti ti-clock me-1"></i
                >{{ getDaysUntilEvent(event.startDateTime) }}
              </span>
            </div>
            <div class="card-body">
              <h5 class="card-title fw-bold">{{ event.title }}</h5>
              <p class="card-text text-muted">
                {{ event.description | slice : 0 : 100 }}...
              </p>

              <div class="d-flex align-items-center mb-3">
                <i class="ti ti-calendar text-primary me-2"></i>
                <small>{{ event.startDateTime | date : "mediumDate" }}</small>
              </div>

              <div class="d-flex align-items-center mb-3">
                <i class="ti ti-clock text-primary me-2"></i>
                <small
                  >{{ event.startDateTime | date : "shortTime" }} -
                  {{ event.endDateTime | date : "shortTime" }}</small
                >
              </div>

              <div class="d-flex align-items-center mb-3">
                <i class="ti ti-map-pin text-primary me-2"></i>
                <small>{{ event.location }}</small>
              </div>

              <div
                class="d-flex justify-content-between align-items-center mb-3"
              >
                <div>
                  <i class="ti ti-ticket text-primary me-2"></i>
                  <small
                    >{{ event.availableSeats }} of {{ event.capacity }} seats
                    available</small
                  >
                </div>
                <span class="badge bg-success">
                  <i class="ti ti-currency-dollar me-1"></i
                  >{{ event.price | number }}
                </span>
              </div>

              <div class="progress mb-4" style="height: 6px">
                <div
                  class="progress-bar bg-success"
                  [style.width]="
                    ((event.capacity - event.availableSeats) / event.capacity) *
                      100 +
                    '%'
                  "
                ></div>
              </div>
            </div>
            <div class="card-footer border-0 bg-transparent">
              <button
                [disabled]="getDays(event?.startDateTime) < 0"
                class="btn btn-primary w-100"
                (click)="viewEventDetails(event.id!)"
              >
                <i class="ti ti-ticket me-2"></i>Make Reservation
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
